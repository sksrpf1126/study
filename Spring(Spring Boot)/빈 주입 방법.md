# **_빈 주입 방법(DI 방법)_**

빈 주입 방법 그러니까 의존성 주입하는 방법에는 크게 4가지가 존재한다.

1. 필드 주입
2. 수정자 주입(setter 주입)
3. 생성자 주입
4. 일반 메소드 주입(수정자 주입과 크게 다르지 않음)

위 4가지로 나뉘는데, 일반 메소드 주입의 경우 수정자 주입이랑 크게 다를게 없기 때문에 필드, 수정자, 생성자 이 3가지로 나누어서 정리

</br>

---

## **_필드 주입 방법_**

```java
public class MemberService{

    @Autowired
    private MemberRepository memberRepository;
}
```

위와 같이 스프링 프레임웤에서 지원해주는 @Autowired를 통해서 주입하는 방식이다.  
객체가 먼저 만들어진 후에 의존성(빈)이 주입되기 때문에, final 키워드를 사용할 수가 없다.

다른 방법들과는 달리 한줄이면 의존성이 주입되기 때문에 코드가 매우 간결하여 과거에 많이 사용되는 방법이었다고 한다.  
지동으로 프레임웤이(정확히는 스프링 컨테이너(?)) 의존성을 주입해주기 때문에 좋을꺼라 생각하지만 오히려 이것이 외부에서는 접근이 불가능하기 때문에 테스트 코드의 중요성이 점점 부각되어 가는 요즘, 해당 방법으로는 테스트 코드 작성에 맞지가 않는다.

적합하지 않는 이유는 테스트 코드는 보통 프레임웤에 의존하지 않는 순수 자바코드를 통해 테스트를 하는데 그렇기에 외부(개발자)에서 의존성을 주입하게 된다.  
하지만 위 방법은 개발자가 의존성을 마음대로 주입할 수 가 없는 것이다.

또한, 위 코드는 프레임웤에 의존적이라는 것이다. 저 위에 코드에서 프레임워크가 사라진다면 저 코드는 정상적으로 작동할 수가 없다. (생성자나, 수정자는 정상작동이 가능)

</br>

---

## **_수정자(setter) 주입 방법_**

```java
public class MemberService{

    private MemberRepository memberRepository;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository){
        this.memberRepository = memberRepository;
    }
}
```

위 방식이 수정자 주입 방법이다.  
해당 방법 또한 객체가 만들어진 후에 의존성을 주입하기 때문에 변수에 final 키워드 사용이 불가능하다.  
위 방법은 보통 주입받는 객체를 변경할 때 사용되는 방법이다.(하지만 변경이 필요한 경우는 거의거의 드물다고 한다.)

불변성이 보장이 안된다. (setter에 의해 변경 가능)

</br>

---

## **_생성자 주입 방법_**

```java
public class MemberService{

    private final MemberRepository memberRepository;

    @Autowired
    public MemberService(MemberRepository memberRepository){
        this.memberRepository = memberRepository;
    }
}
```

위 방법이 생성자 주입 방법이다.

우선 final 키워드가 사용이 가능하다. 그 이유는 생성자를 통해 필수로 객체가 만들어 질 때!!! 의존성이 주입되기 때문이다.

생성자로만 접근해서 의존성이 주입되기 때문에 불변성이 보장이 된다. 수정자 주입 방법같이 의존 관계를 변경하는 일이 거의 일어나지 않는데 열어놓는 것은 좋지 않은 방법이다. 하지만 해당 방법으로는 이를 배제하며, 불변성을 보장한다.

다음으로, 테스트 코드의 작성에서의 장점이다.  
위에서 말했듯이 테스트 코드를 작성할 때에는 프레임웤에 의존하는 코드보다는 순수 자바코드로 작성하는 것이 적합하다.  
위 방법을 이용하면 순수 자바코드로 객체를 만들 때 의존관계를 주입할 수 있다.

그리고 생성자의 파라미터를 통해서 어떠한 객체가 들어올지 유추가 가능하다.

### **_정리_**

스프링에서도 생성자 주입 방법으로 의존관계를 맺어주는 것을 권장한다. 그만큼 해당 방법이 공식적으로도 인정을 받았다는 것이다.  
그렇기에 의존관계는 생성자 주입 방법으로 설정하자.

</br>

---

# **_참고_**

- https://mangkyu.tistory.com/125
