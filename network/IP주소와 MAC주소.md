# IP 주소와 MAC 주소

- ## **_IP란?_**

  - IP는 Internet Protocol 로써, 인터넷에 연결되어 있는 모든 인터페이스(라우터, 컴퓨터 등등)를 식별할 수 있도록 각각의 인터페이스에 부여되는 주소
  - IP주소는 초기에 IPv4라는 방식으로 주소를 부여
  - IPv4는 총 32비트 방식으로 8비트씩 나누어 십진수로 표현한 주소체계이며, 0.0.0.0 ~ 255.255.255.255까지의 범위를 가짐  
  하지만 이 주소체계로는 약 42억 9000만개정도만 사용이 가능하였고, 이 방식으로는 현재의 인터넷에 사용하는 모든 인터페이스에게 할당이 불가능  
  그래서 이를 해결하기 위하여 나온 주소 체계가 IPv6방식으로, 128비트를 활용하여 주소를 부여함  
  그런데 기존의 주소체계가 이미 IPv4방식으로 사용이 되고 있어 이 주소체계를 변경하는데 비용이 많이 든다고 하여 상용화가 아직 되지 않음  
  이를 해결하기 위한 다른 방법으로 공인IP, 사설IP로 나누는 방법, 서브넷팅을 활용하는 방법으로 IP를 효율적으로 사용

    </br>

---

- ## **_IP 종류_**

  - ### 공인IP (외부IP)

    - 공인IP는 전세계에서 유일한 IP주소이며, 해당 IP를 부여받은 인터페이스만이 인터넷으로 나가 통신을 할 수 있음
    - 기본적으로는 ISP(대표적으로 KT, LG, SKT와 같은 인터넷 제공 업체)측에서 제공하는 공인 IP주소로 인터넷을 이용함
    - ISP측의 서브넷팅을 통하여 보통은 가정집 하나당 공인IP하나만을 준다고 함  
      </br>

  - ### 사설IP (내부 IP)

    - 로컬IP라고도 불리며, 라우터 이하의 로컬 네트워크를 구분짓기 위한 IP로, 공인IP와는 상관없는 IP 주소

    </br>

    ```
    우리집 구조

    회선 ⇀ 모뎀(SKT) ⇀ 라우터(공유기, 공인IP) ⇀ PC1, PC2 (사설IP)
                               ↳  와이파이 (사설 IP)
    ```

  - ### 고정IP

    - 말 그대로의 의미로, 고정된 IP를 가지는 것
    - IPv4 주소의 부족으로 고정IP는 비용을 추가적으로 지불해야 사용 가능

    </br>

  - ### 유동IP

    - DHCP (Dynamic Host Configuration Protocol)라고도 하며, IP가 필요한 컴퓨터에 유동IP를 부여하고, 사용이 종료되거나 공유기 설정에서의 시간설정으로 일정 시간마다 기존 IP를 회수하고 새로운 IP를 부여(끊김 현상 발생가능)

      </br>

---

- ## **_서브넷, 서브넷 마스크, 서브넷팅_**

  - **_"서브넷"_** 은 네트워크 영역(대역)을 부분적을 나눈 네트워크를 의미하며, 이러한 서브넷을 만들 때 사용하는 것이 **_"서브넷 마스크"_** (Network ID와 Host ID를 분리하기 위해 사용), 서브넷을 만드는 과정을 **_"서브넷팅"_** 이라 함

  - **_"서브넷팅"_** 을 하기 위해선 나눌 수 있는 처음의 네트워크 대역이 필요하고, 이 처음의 네트워크 대역을 가지게 하기위한 서브넷 마스크도 기본적으로 있어야하는데 이를 **_"디폴트 서브넷 마스크"_** 라 함

  - **_"서브넷 마스크"_** 의 구조는 IPv4 주소와 동일하게 32비트로 이루어져 있으며, 8비트마다 옥텐으로 구분하여, 총 4옥텐으로 이루어져있음  
    1과 0으로 이루어져 있으며, 맨앞 비트부터 무조건 1이 연속으로 나와서 구성되어 있어야한다.
    1이 채워져 있는 부분을 Network ID라 하며, 0으로 채워져 있는 부분을 Host ID라 한다.  
    </br>

      <p align ="center"><img src="https://user-images.githubusercontent.com/62879192/184642189-fc1e2663-3252-4ac7-8e35-81d40c3eeed1.png"></p>

  - 위 이미지는 공인IP를 첫번째 옥텐(맨앞 8비트)의 값으로 클래스를 나눈 것으로 위 IP에 따라 **_"디폴트 서브넷 마스크"_** 를 필수로 가지고 이를 기반으로 처음의 네트워크 대역이 정해지는 것 (클래스마다 디폴트 서브넷 마스크가 다름)

  - 첫째 옥텐이 0~127범위인 IP는 Class A이며, Class A의 디폴트 서브넷 마스크는 255.0.0.0 (<span style="color:red">11111111</span>.<span style ="color : skyblue">00000000.00000000.00000000</span>)로, 빨간색 부분이 Network ID, 하늘색 부분이 Host ID이다.

    ```
    예) 100.0.0.0 의 공인IP를 부여받았을 경우
    Class A이며, 디폴트 서브넷 마스크는 255.0.0.0
     100.0.0.0 -> 01100100.00000000.00000000.00000000 (IP)
     255.0.0.0 -> 11111111.00000000.00000000.00000000 (서브넷 마스크)
     -------------------------------------------------
     AND 연산 :   01100100.00000000.00000000.00000000(100.0.0.0)
     100.0.0.0이 해당 IP 디폴트 서브넷 마스크에 서브넷이다.
     디폴트 서브넷 마스크의 Network ID와 AND연산이 된 부분은 해당IP가 가질 수 있는 기본 네트워크 대역(처음의 네트워크 대역)이며, 위에서 100 부분을 의미
     나머지 Host ID는 말 그대로 해당 대역에서 사용할 수 있는 host의 수로 255 * 255 * 255 = 16,777,216개의 IP를 해당 대역에서 자유롭게 사용할 수 있는 것
    ```

    하지만 이와 같이 디폴트 서브넷 마스크로만 네트워크 대역을 나누어서 사용하는 경우 Class A의 IP를 받은 회사가 10000 대의 장비에 IP를 새롭게 부여해준다 하면, 나머지 16,767,216개의 IP는 사용하지 않게 되는 것이고, 이는 IPv4 주소체계의 귀한 자원을 낭비하게 되는 것이다.  
    그래서 이를 해결하기 위해서 디폴트 서브넷 마스크 이외에 사용자 정의로 서브넷 마스크를 지정하여 네트워크 대역을 세부적으로 나누어 자원을 효율적으로 사용할 수 있게 하는것이 **_"서브넷팅"_** 이다.

    </br>

  - Class B의 디폴트 서브넷 마스크는 255.255.0.0, Class C는 255.255.255.0이며, D는 멀티캐스트 E는 나중에 사용하기위해 예약이 되어있는 부분을 의미하며, Class A~ C까지만 잘 알아두면 됨

  </br>
  </br>

    <p align ="center"><img src="https://user-images.githubusercontent.com/62879192/185390344-271081b1-ee02-4d5c-a8e9-6cda495dbc07.png"></p>

  - 해당 이미지는 사설IP 대역을 클래스 별로 나눈 것

  </br>
  </br>

<p align = "center">
<img src="https://user-images.githubusercontent.com/62879192/185392651-eb4567f6-643a-4411-9dc9-e528486f9907.png" width = 45%>
<img src="https://user-images.githubusercontent.com/62879192/185392782-df3ebfe2-7e42-430c-a726-17ff349b38d8.png" width = 45%>
</p>

- 왼쪽은 내 컴퓨터의 사설IP주소, 오른쪽은 내 노트북의 사설IP 주소이다.
- 192.168로 시작하는 사설IP이며, 서브넷 마스크는 C클래스, 왼쪽 네트워크 대역대는 192.168.55.XXX 오른쪽의 경우는 192.168.45.XXX 대역대를 지님

 </br>

---

- ## **_예제로 서브넷팅 총정리_**

  IP 213.215.21.0 이며, 사용자가 정의한 서브넷 마스크는 255.255.255.240 일때

  11010101.11010111.00010101.00000000  
  <span style= "color : red">11111111.11111111.11111111</span>.<span style = "color : skyblue">1111</span><span style ="color : #81c147">0000</span>

  첫번째 옥텐이 213 -> Class C이며, 디폴트 서브넷 마스크는 255.255.255.0  
  빨간색 부분 -> 해당 IP가 가질 수 있는 기본 네트워크 대역(213.215.21.0 ~ 213.215.21.255 대역)  
  하늘색 부분 -> 사용자 서브넷 마스크로 지정한 네트워크 대역  
  연두색 부분 -> 호스트 영역  
  빨간색 부분의 AND연산을 통해 213.215.21.0 이 서브넷 네트워크 (해당 IP의 기본 네트워크 대역)가 되며, 하늘색 부분(240 값)이 사용자가 서브넷팅을 통해 서브넷을 세부적으로 나누기 위해 정의한 값이 되고,
  하나의 서브넷에 Host 수는 연두색 부분 즉 2^4 으로 16개가 된다.

  정리하면 기본 서브넷 마스크에 의하여 256개(213.215.21.0 ~ 213.215.21.255)의 호스트를 가질 수 있던 IP를 사용자 정의한 서브넷 마스크로 세부적으로 서브넷을 나누었고, 256-240 즉 16개의 호스트로 서브넷을 세부적으로 나눈 것
  그럼 서브넷의 수 또한 256(기존 호스트 수) % 16(세부적으로 나눈 서브넷의 호스트 수) -> 16(서브넷 수)

  하나의 서브넷에 16개의 Host가 할당이 가능하게 되었지만, 정확히는 네트워크 주소라는 하나의 서브넷의 네트워크 대역 IP는 첫번째 IP를 부여받고, 브로드캐스트 주소라는 주소가 맨 끝 IP를 부여받기 때문에 하나의 서브넷으로 사용할 수 있는 Host의 수는 14개이다. (gateway까지 가져갈 경우에는 13개)

  **_"브로드캐스트주소"_** 란 장비가 자신을 알리기 위해선 "브로드캐스트" 라는 행위를 하게 되는데 이 주소는 호스트 대역이 모두 1로 채워지는 것 (서브넷의 제일 끝 IP)

  마지막으로, 이렇게 나눈 서브넷들은 결국 각각 **_"네트워크 대역"_** 이기 때문에 서로 다른 네트워크라는 의미이다.
  그래서 3계층 장비(라우터, L3 스위치)로만 통신이 이루어질 수 있다. (VLAN 기술을 통해 L2 스위치에서도 IP대역을 논리적으로 나눌 수 있다(?))

</br>

---

- ## **_MAC 주소_**

  - 데이터링크 계층(2계층)에서 통신을 위해 사용되는 **_"고유 식별자(물리적 주소)"_**

  - IP 주소는 공인IP끼리 고유한 값이고, 사설대역으로 들어와서 사설IP를 사용할 경우에는 해당 네트워크 대역에서만 고유한 값이다. 그래서 가정마다 사설IP를 쓰는 곳에는 나와 같은 사설IP가 존재할 수 밖에 없는 것이어서, IP가 하나의 값만 가진다라고 정의하기에는 말이 맞지가 않음  
    하지만, MAC 주소는 컴퓨터, 노트북, 스마트폰과 같은 장비에 고유한 값으로 전세계에서 유일한 주소 값이다.

  - 예시로, 대학교에 나와 같은 **_"이름"_** 은 존재할 수 있지만 나와 같은 **_"학번"_** 은 존재할 수 없는 것으로 비유할 수 있다.

</br>

---

- ## **_IP와 MAC 둘 다 필요한가_**

  - MAC 주소만을 가지고 통신을 한다면  
    ->인터넷에서 목적지 ip까지 가기 위해서 네트워크 대역대를 통해 여러 라우터를 최적의 경로로 돌아다니는 라우팅과정을 거쳐서 목적지 ip의 라우터로 보통 접근하게 되는데
    이러한 논리적인 ip주소가 아닌 mac주소만을 가지고 통신이 이루어질려면 모든 라우터에는 모든 컴퓨터의 mac주소가 있어야 하며, 랜카드가 변경되는 경우에는 새롭게
    mac주소가 부여되기 때문에 현실적으로 불가능하다.

  - IP주소만을 가지고 통신을 한다면 (참고 : https://kldp.org/node/122290)  
    -> 결국 라우터까지는 공인IP (unique 한 ip주소)를 가지고 라우터까지 찾아가게 될 것이며, 거기서 내부망(사설 ip) 또한 결국 unique한 값으로 부여되기 때문에 mac주소가
    아닌 ip주소로만 통신이 가능하지 않을까? 에 대한 답은 기술적으로 mac주소가 아닌 ip주소만을 가지고 통신이 되게 구현을 할 수도 있을 것이며,이 외에 다른 방식으로도
    할 수 있겠지만 2계층 장비끼리는 MAC주소로 통신을 하자는 생각으로 만들어왔고, 만들고 있으며, 그걸 지금까지 전세계적으로 사용을하고 있기 때문.
    CPU 안에 꼭 레지스터가 들어가 있어야 하냐는 질문과 비슷
    기술적으로 분리할 수 있을터이지만 CPU안에 레지스터가 들어가 있는 것도 이전에 그렇게 만들어 왔고, 사용해 왔으며 값 또한 그렇게 받아왔다.

    **_추가 )_** ARP를 이해하면 MAC주소가 어떻게 왜 쓰이는지 자세히 알 수 있음

    </br>

---

# **_참고_**

- https://study-recording.tistory.com/7 [IP란 무엇인가]
- http://www.codns.com/b/B05-104 [공인IP/사설IP 클래스]
- https://onestone-note.tistory.com/8?category=503095 [IP 종류]
- https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=hai0416&logNo=221565017478 [서브넷마스크와 서브넷팅]
- https://limkydev.tistory.com/166?category=954021 [서브넷마스크와 서브넷팅 2]
- https://wogh8732.tistory.com/30 [서브넷마스크]
- https://run-it.tistory.com/13?category=663597 [MAC 주소란?]
