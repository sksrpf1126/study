# **_HTTP와 HTTPS 차이_**

- ## **_HTTPS란?_**

  HTTP는 데이터를 주고받는 과정에서 암호화 없이 평문 데이터로 주고받게 된다.  
  그렇기에 주민등록번호, 아이디, 비밀번호 와 같은 개인정보들을 주고 받게 되는 과정에서 보안적으로 문제가 생기게 되는데, 이러한 문제를 HTTP에 데이터 암호화를 해주는 프로토콜(SSL or TLS)을 추가하여 위의 문제를 해결한 HTTPS가 등장하게 되었다.

  **_SSL_** 은 **_TLS_** 와 같은 말이다.  
  네스케이프에 의해서 SSL이 발명되고, 이것이 점차 사용이 많이 되자 표준화 기구인 IETF의 관리로 변경되면서 이름 또한 TLS로 변경이 된 것이다.  
  하지만 TLS 이름보다는 SSL이 더 많이 사용됨

  </br>

---

- ## **_HTTPS 암호화 복호화 방식_**

  HTTPS 는 암호화, 복호화 하는 방식으로 대칭키 방식과 비대칭키 방식 **_둘 다 사용_** 한다.

  **_대칭키 방식_** 이란

  - 클라이언트와 서버 둘 다 동일한 키를 사용하여 서로간의 데이터를 암호화 또는 복호화를 하는 것이다.
  - 해당 방식은 연산 속도가 빠르지만, 키가 노출될 경우에는 타인이 키를 통해 데이터를 복호화 할 수 있기에 위험이 존재

  </br>

  **_비대칭키 방식_** 이란

  - 1개의 쌍으로 이루어진 공개키/개인키(비밀키)를 통하여 암호화와 복호화를 하는 것이다.
  - 공개키로 암호화한 내용은 개인키로 복호화하고, 개인키로 암호화한 내용은 공개키로 복호화를 할 수 있다.
  - 연산 속도는 대칭키에 비해 느리지만, 하나의 키가 노출되어도 보안적으로 안전하다. (일반적으로 보안에 취약한 클라이언트 쪽에 공개키를, 서버는 개인키를 가지고 암호화, 복호화를 진행)

  </br>

  ***

- ## **_HTTPS 인증서 발급_**

  HTTPS를 사용하기 위해서는 CA기관(Certificate Authority)이라는 공개키를 저장해주는 신뢰성이 검증이 된 민간기업에서 인증서를 발급 받아야 한다.

  인증서 발급 절차

  1. HTTPS를 사용하고자 하는 A기업은 자신의 애플리케이션에 공개키와 개인키를 만들어 둔다.
  2. CA기관을 선택하여, 돈을 지불하고 A기업의 공개키를 저장(관리)해주는 인증서를 만들어달라 요청
  3. CA기관측은 계약이 성립되면, A기업의 공개키와 A기업에 대한 정보등을 하나의 인증서로 만들며, CA기관 내의 개인키를 통해 인증서를 암호화하여 A기업측에 제공한다.

  </br>
  사설 CA기관도 존재하며, 인증된 기관이 아닌 방식으로 인증서를 사용할 경우

  </br>
      <p align = "center"><img src="https://user-images.githubusercontent.com/62879192/187064529-5e255ac3-c683-4bda-a925-385b958b600e.png" height = 100px></p>  
      와 같이 브라우저 자체에서 판단을 내리서 보여준다.

</br>

---

- ## **_HTTPS 동작 방식_**

  </br>
    <p align = "center"><img src="https://user-images.githubusercontent.com/62879192/187064533-78006d38-5157-44c2-87fd-72f3679b1228.png" style = "background-color : white"></p>
    출처 : https://velog.io/@moonyoung/HTTPS의-원리

    </br>

  **_동작 방식_**

  **_위 SSL 통신을 하기 전_**  
   TCP 3-way handshaking을 먼저 진행하여 연결을 맺는다.

  **_1.client hello_**  
  클라이언트 -> 서버로 클라이언트가 생성한 랜덤 데이터와 클라이언트 측에서 사용이 가능한 암호화 방식들을 서버측으로 넘겨준다.

  **_2. server hello_**  
  서버 -> 클라이언트로 서버 또한 서버에서 생성한 랜덤데이터와 클라이언트가 넘겨준 암호화 방식들 중에서 하나를 택해 클라이언트에게 전달해주며, 위 CA기관으로부터 받은 서버의 공개키가 들어있는 **_인증서_** 또한 같이 전달한다.

  **_3. 인증서 확인_**  
  브라우저는 서버측에서 제공한 인증서를 복호화하는데 복호화 하기위해서는 인증서를 암호화한 CA기관측의 공개키를 활용해야 한다.  
  브라우저는 일반적으로 CA기관들의 공개키들을 가지고 있으며, 없을 경우 인터넷을 통해 CA기관과 그에 대한 공개키를 알아온다.  
  공개키를 알아왔다면 이를 통해 인증서를 복호화 한다.  
  복호화를 통해 서버의 공개키를 알아왔다면, 1번과 2번에서 생성한 랜덤데이터를 조합하여 premaster secret키를 만든다.

  **_4. premaster secret 암호화_**  
  3번에서 만든 premaster secret키를 인증서 안에 있던 서버의 공개키를 통해 암호화하여 서버측으로 전달한다.

  **_5. premaster secret 복호화_**  
  4번에서 전달해준 premaster secret키를 서버의 개인키를 통해 복호화를 진행한다.

  **_6. session key 생성_**  
  클라이언트, 서버 둘 다 가지고 있는 premaster secret키를 통해 session key를 만든다.

  **_7. 대칭키 방식을 통한 데이터 송수신_**  
  양쪽에 session key라는 대칭키가 존재하게 되고, 이를 통해 서로간에 데이터를 암호화, 복호화를 하여 주고 받게 되는 것이다.

  </br>

  결국 HTTPS는 session key를 클라이언트, 서버측 둘 다 안전하게 생성하기 위하여 비대칭키 방식으로 통신하고, 이후에 session key가 생성이 되었다면 이를 이용하여 대칭키 방식으로 데이터를 주고받는 것이므로 HTTPS는 대칭키, 비대칭키 방식을 둘다 이용하는 것이다.

  이러면, 비대칭키 방식과 대칭키 방식의 단점은 보완하고 장점은 효율적으로 사용할 수 있는 것이다.

</br>

---

# **_참고_**

https://mangkyu.tistory.com/98 [망나니 개발자 - http와 htts]  
https://velog.io/@moonyoung/HTTPS%EC%9D%98-%EC%9B%90%EB%A6%AC [https 동작에 대해]
